# -*- coding: utf-8 -*-

# ======================================================================================================================
#
#
#
#                               001. Feature importance using random forest
#
#
#
# ======================================================================================================================


# ----------------------------------------------------------------------------------------------------------------------
# 0. Set Environments
# ----------------------------------------------------------------------------------------------------------------------

# --------------------------------------->>> [Import modules]

import numpy as np
import pandas as pd

from sklearn.ensemble import RandomForestRegressor

# ----------------------------------------------------------------------------------------------------------------------
# 1. Function definition
# ----------------------------------------------------------------------------------------------------------------------


def rf_imp_fn(X, y, n_estimators):

    reg_rf = RandomForestRegressor(n_estimators = n_estimators,
                                   random_state = 0)
    reg_rf.fit(X, y)

    dt_list = reg_rf.estimators_

    imp_df_arr = np.array(list(map(lambda x : x.feature_importances_, dt_list)))

    return imp_df_arr






























